:root{
  --bgA:#ffcadf;
  --bgB:#d7b6ff;
  --glass: rgba(255,255,255,0.72);
  --shadow: rgba(0,0,0,0.14);
  --ink:#161616;
  --muted:#6a6a6a;
  --red:#b10b0b;
  --paper:#fff7ef;
  --line:#f1d6d6;
  --yes:#ff2f77;
  --yes2:#ff4d87;
  --dark:#111;
}

*{box-sizing:border-box;}

body{
  margin:0;
  min-height:100vh;
  font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
  color:var(--ink);
  background:
    radial-gradient(1100px 600px at 20% 15%, var(--bgB), transparent),
    radial-gradient(1000px 700px at 80% 30%, var(--bgA), transparent),
    linear-gradient(135deg, #ffe4ef, #eddcff);
  overflow-x:hidden;
}

#confettiCanvas{
  position:fixed;
  inset:0;
  pointer-events:none;
  z-index:5;
}

.app{
  min-height:100vh;
  display:grid;
  place-items:center;
  padding:22px;
}

.screen{display:none; width:min(900px, 100%);}
.screen--active{display:block;}

.card{
  width:100%;
  padding:26px 20px;
  border-radius:18px;
  box-shadow:0 18px 60px var(--shadow);
  border:1px solid rgba(255,255,255,0.6);
}

.glass{
  background:var(--glass);
  backdrop-filter: blur(10px);
}

.title{
  margin:12px 0 8px;
  text-align:center;
  font-size:clamp(22px, 3.4vw, 36px);
  font-weight:900;
  letter-spacing:-0.02em;
  text-transform:none;
  font-family: "Lilita One", ui-sans-serif, system-ui;
}

.title2{
  margin:6px 0 10px;
  text-align:center;
  font-size:clamp(20px, 2.8vw, 30px);
  font-weight:900;
  letter-spacing:-0.02em;
  text-transform:none;
  font-family: "Lilita One", ui-sans-serif, system-ui;
}

.pop{
  display:inline-block;
  padding:2px 10px;
  border-radius:999px;
  background: rgba(255,47,119,0.12);
}

.subtle{margin:0; text-align:center; color:var(--muted);}
.center{text-align:center;}
.tiny{font-size:12px; color:rgba(0,0,0,0.55); margin:10px 0 0;}

.arena{
  position:relative;
  width:min(520px, 100%);
  margin:18px auto 0;
  min-height:92px;
  display:flex;
  justify-content:center;
  align-items:center;
  gap:16px;
}

.btn{
  border:none;
  border-radius:999px;
  padding:12px 22px;
  font-weight:800;
  cursor:pointer;
  box-shadow:0 12px 24px rgba(0,0,0,0.14);
  transition: transform 140ms ease, background 140ms ease;
  user-select:none;
}

.btn:active{transform: scale(0.96);}

.btn-yes{background:var(--yes); color:#fff;}
.btn-yes:hover{background:var(--yes2);}

.btn-no{
  background:#f1f1f1;
  color:#222;
  position:absolute;
  left:62%;
  top:50%;
  transform: translate(-50%, -50%);
}

.btn-dark{background:var(--dark); color:#fff;}
.btn-dark:hover{background:#000;}
.small{padding:10px 16px; font-size:14px;}

.navRow{
  display:flex;
  justify-content:center;
  margin-top:16px;
}

.actions{
  display:flex;
  justify-content:center;
  align-items:center;
  gap:14px;
  margin-top:18px;
}

.hint{
  text-align:center;
  margin-top:12px;
  color: var(--muted);
  font-weight:700;
}

/* Kitty */
.kittyWrap{ display:grid; place-items:center; }
.kitty{ position:relative; width:92px; height:72px; }

.face{
  position:absolute;
  inset:6px 0 0 0;
  margin:auto;
  width:82px;
  height:58px;
  background:#f3b57c;
  border-radius:999px;
  box-shadow:0 10px 18px rgba(0,0,0,0.12);
}

.ear{
  position:absolute;
  width:0; height:0;
  border-left:14px solid transparent;
  border-right:14px solid transparent;
  border-bottom:22px solid #f3b57c;
  top:-2px;
}
.ear-left{ left:10px; transform:rotate(-10deg); }
.ear-right{ right:10px; transform:rotate(10deg); }

.eye{
  position:absolute;
  width:10px; height:10px;
  background:#111;
  border-radius:50%;
  top:34px;
}
.eye-left{ left:30px; }
.eye-right{ right:30px; }

.nose{
  position:absolute;
  width:10px; height:10px;
  background:#ff5aa0;
  border-radius:50%;
  top:42px;
  left:50%;
  transform:translateX(-50%) rotate(45deg);
}

.heart{
  position:absolute;
  width:26px; height:26px;
  right:-6px; top:-4px;
  background:#ff2f77;
  transform:rotate(45deg);
  border-radius:6px;
  opacity:0.95;
}
.heart:before,.heart:after{
  content:"";
  position:absolute;
  width:26px; height:26px;
  background:#ff2f77;
  border-radius:50%;
}
.heart:before{ left:-13px; top:0; }
.heart:after{ left:0; top:-13px; }

/* =========================
   YAY SCREEN FINAL (CLEAN)
   ========================= */

#screenYay .card{
  padding: 26px 20px;
}

.yayTop{
  display:flex;
  flex-direction:column;
  align-items:center;
  gap:14px;
  margin-bottom:18px;
  text-align:center;
}

.kittyIcon{
  font-size:56px;
  filter: drop-shadow(0 10px 22px rgba(0,0,0,0.15));
}

.yayBody{
  display:flex;
  justify-content:center;
  align-items:center;
  padding: 8px 0 10px;
}

/* Video container */
.yayVideoWrap{
  width: min(720px, 92vw);
  aspect-ratio: 16 / 9;
  border-radius: 18px;
  overflow:hidden;
  background: rgba(255,255,255,0.55);
  border: 2px solid rgba(255, 180, 205, 0.7);
  box-shadow: 0 14px 34px rgba(0,0,0,0.12);
}

/* Video itself */
.surpriseVideo{
  width:100%;
  height:100%;
  display:block;
  object-fit: contain;
  background: rgba(255,255,255,0.35);
}

/* Envelope */
.envelope{
  margin:16px auto 6px;
  width:min(420px, 100%);
  aspect-ratio: 16/10;
  background: transparent;
  border:none;
  cursor:pointer;
  position:relative;
  display:block;
}

.envBody{
  position:absolute;
  inset:0;
  background: linear-gradient(180deg, #c20f0f, #8f0a0a);
  border-radius:18px;
  border: 5px solid rgba(255,255,255,0.55);
  box-shadow: 0 22px 70px rgba(0,0,0,0.22);
}

.envTop{
  position:absolute;
  left:0;
  right:0;
  top:0;
  height:58%;
  background: linear-gradient(180deg, #ffb3c7, #ffd7e2);
  border-radius: 18px 18px 0 0;
  clip-path: polygon(0 0, 100% 0, 50% 86%);
  border: 5px solid rgba(255,255,255,0.55);
  border-bottom:none;
}

.waxSeal{
  position:absolute;
  left:50%;
  top:52%;
  transform: translate(-50%, -50%);
  width:90px;
  height:90px;
  border-radius:999px;
  background: rgba(255,255,255,0.55);
  border: 3px solid rgba(255,255,255,0.8);
  box-shadow: 0 14px 28px rgba(0,0,0,0.18);
  color:#b10b0b;
  font-weight:900;
  display:grid;
  place-items:center;
  text-transform: lowercase;
}

/* Book / postcard theme */
.bookWrap{
  width:min(980px, 100%);
  margin:0 auto;
}

.bookHeader{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:12px;
  margin-bottom:12px;
}

.bookTitle{
  font-weight:900;
  font-size:20px;
}

.bookControls{
  display:flex;
  gap:10px;
}

.postcard{
  background: linear-gradient(180deg, #b10b0b, #8a0808);
  border-radius:18px;
  padding:18px;
  box-shadow: 0 18px 60px rgba(0,0,0,0.22);
}

.postcardTop{
  display:flex;
  justify-content:center;
  align-items:center;
  position:relative;
  padding:6px 0 12px;
}

.date{
  background: rgba(255,255,255,0.12);
  color:#fff;
  border:1px solid rgba(255,255,255,0.22);
  padding:6px 12px;
  border-radius:999px;
  font-weight:800;
  letter-spacing:0.08em;
  font-size:12px;
}

.sealBadge{
  position:absolute;
  top:-6px;
  width:86px;
  height:86px;
  border-radius:999px;
  background: rgba(255,255,255,0.5);
  border: 2px solid rgba(255,255,255,0.75);
  box-shadow: 0 14px 28px rgba(0,0,0,0.18);
}

.postcardBody{
  background: var(--paper);
  border-radius:14px;
  padding:22px 20px 22px;
  position:relative;
  border: 2px solid rgba(124,10,10,0.25);
  overflow:hidden;
  min-height: 480px;

  /* cut-corner look */
  clip-path: polygon(
    18px 0%,
    calc(100% - 18px) 0%,
    100% 18px,
    100% calc(100% - 18px),
    calc(100% - 18px) 100%,
    18px 100%,
    0% calc(100% - 18px),
    0% 18px
  );

  box-shadow: inset 0 0 0 2px rgba(255,255,255,0.45);
}

/* lined paper */
.postcardBody:before{
  content:"";
  position:absolute;
  inset:0;
  background:
    repeating-linear-gradient(
      to bottom,
      transparent 0px,
      transparent 22px,
      var(--line) 23px,
      var(--line) 24px
    );
  opacity:0.65;
  pointer-events:none;
}

.handTitle{
  position:relative;
  margin:0 0 10px;
  text-align:center;
  font-size:clamp(24px, 3.4vw, 42px);
  color:#6f0b0b;
  font-weight:900;
  font-family: "Patrick Hand", "Segoe Print", "Bradley Hand", cursive;
}

.cardContent{
  position:relative;
  max-width:720px;
  margin:0 auto;
  padding:6px 10px 0;
  text-align:center;
  font-size:22px;
  line-height:1.8;
  color:#5c1414;
  font-family: "Patrick Hand", "Segoe Print", "Bradley Hand", cursive;
}

.cardContent p{ margin: 0 0 14px; }

.doodles{
  position:absolute;
  left:0;
  right:0;
  bottom:0;
  display:flex;
  justify-content:space-between;
  padding:10px 14px;
  gap:12px;
  pointer-events:none;
  opacity:0.95;
}

.doodles.hidden{ display:none; }

.doodle{
  width:120px;
  opacity:0.9;
  filter: drop-shadow(0 10px 14px rgba(0,0,0,0.18));
}

@media (max-width:720px){
  .doodle{width:120px;}
}

.doodle.left{align-self:flex-end;}
.doodle.right{align-self:flex-end;}

.postcardFooter{
  display:flex;
  justify-content:center;
  padding:12px 8px 6px;
}

.footerLine{
  color:#fff;
  font-weight:900;
  letter-spacing:0.12em;
  text-transform: uppercase;
  font-size:12px;
}

.bookBottom{
  display:flex;
  justify-content:center;
  margin-top:14px;
}

.postcardBody.hasDoodles .cardContent{
  padding-bottom: 190px;
}

@media (max-width:720px){
  .postcardBody.hasDoodles .cardContent{ padding-bottom: 160px; }
}

/* Coupon tickets */
.ticketGrid{
  display:grid;
  grid-template-columns: 1fr 1fr;
  gap:16px;
  margin-top:14px;
}
@media (max-width:640px){
  .ticketGrid{ grid-template-columns:1fr; }
}

.ticket{
  position:relative;
  padding:18px 18px 18px 18px;
  border-radius:14px;
  background: linear-gradient(180deg, rgba(177,11,11,0.95), rgba(138,8,8,0.95));
  color:#fff;
  box-shadow:0 14px 28px rgba(0,0,0,0.18);
  overflow:hidden;
}

.ticket:before,
.ticket:after{
  content:"";
  position:absolute;
  top:50%;
  transform: translateY(-50%);
  width:22px;
  height:22px;
  background: var(--paper);
  border-radius:999px;
  opacity:0.95;
}
.ticket:before{ left:-11px; }
.ticket:after{ right:-11px; }

.ticket .perforation{
  position:absolute;
  left:50%;
  top:10px;
  bottom:10px;
  width:0;
  border-left:2px dashed rgba(255,255,255,0.55);
  transform: translateX(-50%);
}

.ticket .miniLabel{
  position:absolute;
  left:10px;
  top:50%;
  transform: translateY(-50%) rotate(-90deg);
  font-weight:900;
  letter-spacing:0.18em;
  text-transform: uppercase;
  font-size:10px;
  opacity:0.75;
}

.ticket .status{
  position:absolute;
  right:12px;
  top:10px;
  font-weight:900;
  letter-spacing:0.14em;
  text-transform: uppercase;
  font-size:10px;
  opacity:0.75;
}

.ticket .ticketText{
  font-family: ui-serif, Georgia, "Times New Roman", Times, serif;
  font-weight:800;
  text-transform: lowercase;
  text-align:center;
  font-size:28px;
  line-height:1.1;
  padding:10px 18px;
}

/* Song box */
.songBox{
  margin-top:10px;
  display:grid;
  gap:10px;
}

.songRow{
  display:flex;
  flex-wrap:wrap;
  gap:10px;
  justify-content:center;
  align-items:center;
}

.qr{
  width:120px;
  border-radius:14px;
  border:1px solid rgba(0,0,0,0.08);
  box-shadow:0 10px 22px rgba(0,0,0,0.12);
}

/* Record player */
.recordWrap{
  display:grid;
  place-items:center;
  margin-top:14px;
}

.record{
  width:220px;
  height:220px;
  border-radius:999px;
  background:
    radial-gradient(circle at 50% 50%, rgba(0,0,0,0.9) 0 28px, rgba(0,0,0,0.98) 29px 60px, rgba(20,20,20,1) 61px 100%);
  box-shadow:0 18px 40px rgba(0,0,0,0.28);
  position:relative;
  overflow:hidden;
}

.record:before{
  content:"";
  position:absolute;
  inset:0;
  background:
    repeating-radial-gradient(circle at 50% 50%,
      rgba(255,255,255,0.06) 0 2px,
      rgba(0,0,0,0) 3px 10px);
  mix-blend-mode: screen;
  opacity:0.35;
}

.label{
  position:absolute;
  left:50%;
  top:50%;
  transform: translate(-50%, -50%);
  width:92px;
  height:92px;
  border-radius:999px;
  background: linear-gradient(180deg, rgba(255,47,119,0.95), rgba(255,92,146,0.95));
  display:grid;
  place-items:center;
  color:#fff;
  font-weight:900;
  text-transform: uppercase;
  letter-spacing:0.12em;
  font-size:11px;
  text-align:center;
  padding:10px;
}

.label .tap{
  display:block;
  margin-top:8px;
  font-size:10px;
  letter-spacing:0.2em;
  opacity:0.9;
}

.recordHidden{ display:none; }

.spin{
  animation: spin 2.6s linear infinite;
}

@keyframes spin{
  from{ transform: rotate(0deg); }
  to{ transform: rotate(360deg); }
}

/* Panda video */
.pandaVideo{
  width:min(420px, 82vw);
  height:auto;
  border-radius:18px;
  box-shadow:0 16px 36px rgba(0,0,0,0.16);
  border:1px solid rgba(255,47,119,0.16);
  margin: 18px auto 0;
  display:block;
  background: rgba(255,255,255,0.55);
}

/* Sealed screen */
.sealedArt{
  display:grid;
  place-items:center;
  margin:16px 0 6px;
}

.sealedEnv{
  width:min(420px, 100%);
  aspect-ratio:16/10;
  background:#fff;
  border-radius:16px;
  border:4px solid #d7d7d7;
  box-shadow:0 18px 60px rgba(0,0,0,0.18);
  position:relative;
}

.waxSeal.big{
  width:110px;
  height:110px;
  border-radius:999px;
  position:absolute;
  left:50%;
  top:50%;
  transform: translate(-50%, -50%);
  background: rgba(255,255,255,0.55);
  border: 3px solid rgba(255,255,255,0.8);
  display:grid;
  place-items:center;
  font-size:40px;
}
.exitArena{
  position: relative;
  width: 140px;          /* movement area width */
  height: 52px;          /* movement area height */
}

#btnExit{
  position: absolute;    /* key: JS can move it now */
  left: 0;
  top: 0;
}
